!function(t){t.fn.TS_VCSC_HoneycombsGrid=function(e){function a(e){function a(){f=jQuery(e).find(".ts-honeycombs-gallery-loader"),g=jQuery(e).find(".ts-honeycombs-gallery-inner"),m=jQuery(e).find(".ts-honeycombs-gallery-comb").length,jQuery(e).find(".ts-honeycombs-gallery-comb").addClass("ts-honeycombs-gallery-comb-"+r.layout),f.hide()}function o(){if(r.fullWidth)if("false"==jQuery(e).attr("data-inline")){var t=0,a=(jQuery(window).width(),0);if("undefined"==typeof jQuery(e).attr("data-break-parents"))return;var o=parseInt(jQuery(e).attr("data-break-parents"));if(isNaN(o)||0==o)return;for(var s=jQuery(e).closest(".ts-image-gallery-wrapper").parent(),n=s,l=0;o>l&&!n.is("html");l++)n=n.parent(),"none"!=n.css("max-width")&&(t=parseInt(n.css("max-width").replace("px","").replace("%","").replace("em","")));var d=(n.width()+parseInt(n.css("paddingLeft"))+parseInt(n.css("paddingRight"))+parseInt(n.css("marginLeft"))+parseInt(n.css("marginRight")),-(s.offset().left-n.offset().left+1)-parseInt(s.css("marginLeft"))-parseInt(s.css("paddingLeft")));if(d>0&&(d=0),$heightMin=0,$widthMin=n.outerWidth(),$heightMin>parseInt(a));else{parseInt(a)}jQuery(e).closest(".ts-image-gallery-wrapper").addClass("fullwidth"),jQuery(e).closest(".ts-image-gallery-wrapper").css({"min-height":$heightMin+"px",width:$widthMin+"px","min-width":$widthMin+"px",left:parseInt(d)+"px"}),c=jQuery(e).width(),i()}else c=jQuery(e).width(),i();else c=jQuery(e).width(),i()}function i(){"flat"==r.layout?(c>r.breakLarge?(u=r.combFull,jQuery(e).attr("data-currentsize","full")):c>r.breakMedium?(u=r.combLarge,jQuery(e).attr("data-currentsize","large")):c>r.breakSmall?(u=r.combMedium,jQuery(e).attr("data-currentsize","medium")):(u=r.combSmall,jQuery(e).attr("data-currentsize","small")),h=Math.sqrt(3)*u/2,y=u/2):"edge"==r.layout&&(c>r.breakLarge?(h=r.combFull,jQuery(e).attr("data-currentsize","full")):c>r.breakMedium?(h=r.combLarge,jQuery(e).attr("data-currentsize","large")):c>r.breakSmall?(h=r.combMedium,jQuery(e).attr("data-currentsize","medium")):(h=r.combSmall,jQuery(e).attr("data-currentsize","small")),u=Math.sqrt(3)*h/2,y=u/2),jQuery(e).find(".ts-honeycombs-gallery-comb").width(u).height(h),jQuery(e).find(".ts-honeycombs-gallery-hex-left, .ts-honeycombs-gallery-hex-right").width(u).height(h),jQuery(e).find(".ts-honeycombs-gallery-hex-inner").width(u).height(h)}function s(){function a(){jQuery(e).find(".ts-honeycombs-gallery-comb.ts-honeycombs-gallery-active").each(function(){y=n*(h+r.margin)+l*(h/2+r.margin/2)+s,b=Math.max(y,b),t(this).css("left",d).attr("data-positionx",d).css("top",y).attr("data-positiony",y),d+=u-u/4+r.margin,l=(l+1)%2,0==n&&(f+=1),d+u>c&&(d=0,n+=1,l=1)});var a=Math.round((b-s)/((h+r.margin)/2))+1,o=a*(h/2)+a*r.margin+h/2+2*s-2*r.margin,i=f*(u/4*3+r.margin)+u/4;g.width(i).height(o)}function i(){t(e).find(".ts-honeycombs-gallery-comb.ts-honeycombs-gallery-active").filter(":not(.placeholder.hide)").each(function(){y=.5*n*h*Math.sqrt(3),n>0&&(y=y-n*s+n*r.margin),b=Math.max(y,b),t(this).css("left",d).attr("data-positionx",d).css("top",y).attr("data-positiony",y),d+=u+r.margin,d>p&&(p=d),0==n&&(f+=1),d+u+s>c&&(n+=1,l=(l+1)%2,d=l/2*(u+r.margin)+s)}),g.height(y+h).width(p-r.margin+s)}if(o(),newWidth=c>r.breakLarge?m/1.5*r.combFull:c>r.breakMedium?m/1.5*r.combLarge:c>r.breakSmall?m/1.5*r.combMedium:m/1.5*r.combSmall,c>newWidth&&(c=newWidth),g.width(c),"flat"==r.layout)var s=Math.round((h*Math.abs(Math.cos(60))+h*Math.abs(Math.sin(60))-h)/2);else if("edge"==r.layout)var s=Math.round((u*Math.abs(Math.cos(60))+u*Math.abs(Math.sin(60))-u)/2);var n=0;if("flat"==r.layout)var l=1;else if("edge"==r.layout)var l=0;if("flat"==r.layout)var d=0;else if("edge"==r.layout)var d=s;var y=0,f=0,b=0,p=0;"flat"==r.layout?a():"edge"==r.layout&&i()}function n(){if(r.tooltips&&jQuery.isFunction(jQuery.fn.tooltipster)){var t=null,a=jQuery(e).attr("id"),o=jQuery(e).attr("data-tooltipster-position"),i=jQuery(e).attr("data-tooltipster-animation"),s=jQuery(e).attr("data-tooltipster-theme"),n=(parseInt(jQuery(e).attr("data-tooltipster-offsetx")),parseInt(jQuery(e).attr("data-tooltipster-offsety")),0),l=0;jQuery("body").on("mouseenter touchstart","#"+a+" .ts-honeycombs-gallery-tooltip",function(){var a="small"==jQuery(e).attr("data-currentsize")?!1:!0;if(a){if(t=jQuery(this),"true"==t.attr("data-tooltipset"))try{t.tooltipster("destroy").attr("data-tooltipset","false")}catch(r){}var d=(parseInt(t.attr("data-index")),0),c=0;l="bottom"==o?c-TS_VCSC_AdminBarOffset:c+TS_VCSC_AdminBarOffset,n=d,t.tooltipster({multiple:!1,touchDevices:!1,theme:s,arrow:!0,content:jQuery(this).attr("data-tooltipster-text"),contentAsHTML:!0,trigger:"hover",animation:i,onlyOne:!0,position:o,delay:200,minWidth:75,maxWidth:220,iconDesktop:!1,iconTouch:!1,offsetX:n,offsetY:l,interactive:!0,functionInit:function(t){t.attr("data-tooltipset","true")}}),t.tooltipster("show")}}),jQuery("body").on("mouseleave touchend","#"+a+" .ts-honeycombs-gallery-tooltip",function(){if(t=jQuery(this),"true"==t.attr("data-tooltipset")){try{t.tooltipster("destroy").attr("data-tooltipset","false")}catch(e){}t.attr("title","")}})}}function l(){if(r.filter&&"undefined"!=typeof jQuery.fn.multiSelect){if(jQuery(e).find(".ts-honeycombs-gallery-comb").each(function(){if(""!=jQuery(this).attr("data-groups")){var t=jQuery(this).attr("data-groups").split(",");t.forEach(function(t){jQuery.inArray(t,M)<0&&"All"!=t&&M.push(t)})}else jQuery(this).attr("data-groups","NoGroups"),k++}),M.length>0){M.sort();var a=jQuery(e).attr("data-gridtogglestyle"),o=jQuery(e).attr("data-gridshowallstyle"),i=jQuery('<div id="ts-honeycombs-grid-controls-frame-'+v+'" class="ts-honeycombs-grid-controls-frame">').insertBefore(jQuery(e)),n=(jQuery('<div id="ts-honeycombs-grid-controls-toggle-'+v+'" class="ts-honeycombs-grid-controls-toggle '+a+'" data-filter="ts-honeycombs-grid-controls-filter-'+v+'" data-showall="ts-honeycombs-grid-controls-showall-'+v+'" data-random="'+v+'">'+p+"</div>").appendTo(i),jQuery('<div id="ts-honeycombs-grid-controls-showall-'+v+'" class="ts-honeycombs-grid-controls-showall '+o+'" data-filter="ts-honeycombs-grid-controls-filter-'+v+'" data-random="'+v+'">'+b+"</div>").appendTo(i),jQuery('<select id="ts-honeycombs-grid-controls-filter-'+v+'" class="ts-honeycombs-grid-controls-filter" data-toggle="ts-honeycombs-grid-controls-toggle-'+v+'" data-showall="ts-honeycombs-grid-controls-showall-'+v+'" data-random="'+v+'" multiple="multiple"></select>').appendTo(i));M.forEach(function(t){jQuery('<option value="'+t+'">'+t+"</option>").appendTo(n)}),k>0&&jQuery('<option value="NoGroups">'+j+"</option>").appendTo(n)}if(M.length>0){var l=t("#ts-honeycombs-grid-controls-filter-"+v),d=t("#ts-honeycombs-grid-controls-toggle-"+v),c=t("#ts-honeycombs-grid-controls-showall-"+v);l.multiSelect({selectableHeader:"<div class='ms-header-selectable'>"+Q+"</div>",selectionHeader:"<div class='ms-header-selection'>"+w+"</div>",afterSelect:function(){},afterDeselect:function(){}}),l.on("change",function(){var a=t.trim(l.val()),r=a.split(","),o=!1;""!=a?jQuery(e).find(".ts-honeycombs-gallery-comb").each(function(){$block=jQuery(this),groups=t.trim($block.attr("data-groups")),o=!1,r.forEach(function(t){S(groups,t)&&(o=!0),""==groups&&"NoGroups"==t&&(o=!0)}),o?$block.addClass("ts-honeycombs-gallery-active").show().attr("data-showing","true"):$block.removeClass("ts-honeycombs-gallery-active").hide().attr("data-showing","false")}).promise().done(function(){s()}):jQuery(e).find(".ts-honeycombs-gallery-comb").each(function(){$block=jQuery(this),$block.addClass("ts-honeycombs-gallery-active").show().attr("data-showing","true")}).promise().done(function(){s()}),""!=r&&null!=r?c.show():c.hide()});var u=t("#ms-ts-honeycombs-grid-controls-filter-"+v);u.slideToggle(),c.hide(),d.on("click",function(){u.slideToggle()}),c.on("click",function(){l.multiSelect("deselect_all"),jQuery(e).find(".ts-honeycombs-gallery-comb").addClass("ts-honeycombs-gallery-active").show().attr("data-showing","true"),s()})}}}function d(){jQuery(e).find(".nch-lightbox-honeycombs").length>0&&"undefined"!=typeof jQuery.fn.nchlightbox&&jQuery(e).find(".nch-lightbox-honeycombs").off().nchlightbox()}var c=0,u=0,h=0,y=0,m=0,f=null,g=null,b=jQuery(e).attr("data-gridshowall"),p=jQuery(e).attr("data-gridtoggle"),j=jQuery(e).attr("data-gridnogroups"),Q=jQuery(e).attr("data-gridavailable"),w=jQuery(e).attr("data-gridselected"),v=parseInt(jQuery(e).attr("data-random")),M=[],k=0,S=function(t,e){return new RegExp("\\b"+e+"\\b","i").test(t)};jQuery(window).on("debouncedresize",function(){s()}),a(),d(),s(),l(),n()}var r=t.extend({layout:"flat",fullWidth:!1,filter:!1,tooltips:!0,combFull:340,combLarge:250,combMedium:180,combSmall:100,breakLarge:1280,breakMedium:960,breakSmall:640,margin:2},e);return this.each(function(){a(this)})},jQuery(document).ready(function(){jQuery(".ts-honeycombs-gallery-wrapper").each(function(){var t=jQuery(this),e=t.attr("data-layout"),a="true"==t.attr("data-fullwidth")?!0:!1,r="true"==t.attr("data-tooltips")?!0:!1,o="true"==t.attr("data-gridfilter")?!0:!1,i=parseInt(t.attr("data-margin")),s=t.attr("data-breakpoints");s=s.split(","),$breakLarge="undefined"!=typeof s[0]?parseInt(s[0]):1280,breakMedium="undefined"!=typeof s[1]?parseInt(s[1]):960,breakSmall="undefined"!=typeof s[2]?parseInt(s[2]):640;var n=t.attr("data-combsizes");n=n.split(","),$combFull="undefined"!=typeof n[0]?parseInt(n[0]):340,$combLarge="undefined"!=typeof n[1]?parseInt(n[1]):250,$combMedium="undefined"!=typeof n[2]?parseInt(n[2]):180,$combSmall="undefined"!=typeof n[3]?parseInt(n[3]):100,t.TS_VCSC_HoneycombsGrid({layout:e,fullWidth:a,filter:o,tooltips:r,combFull:$combFull,combLarge:$combLarge,combMedium:$combMedium,combSmall:$combSmall,breakLarge:$breakLarge,breakMedium:breakMedium,breakSmall:breakSmall,margin:i})})})}(jQuery);