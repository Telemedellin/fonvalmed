!function(e){e.fn.lightbox_me=function(o){return this.each(function(){function t(){var o=a[0].style;l.destroyOnClose?a.add(c).remove():a.add(c).hide(),l.parentLightbox&&l.parentLightbox.fadeIn(200),d.remove(),a.undelegate(l.closeSelector,"click"),e(window).unbind("reposition",i),e(window).unbind("reposition",s),e(window).unbind("scroll",s),e(window).unbind("keyup.lightbox_me"),r&&o.removeExpression("top"),l.onClose()}function n(e){(27==e.keyCode||27==e.DOM_VK_ESCAPE&&0==e.which)&&l.closeEsc&&t()}function i(){e(window).height()<e(document).height()?(c.css({height:e(document).height()+"px"}),d.css({height:e(document).height()+"px"})):(c.css({height:"100%"}),r&&(e("html,body").css("height","100%"),d.css("height","100%")))}function s(){var o=a[0].style;if(a.css({left:"50%",marginLeft:a.outerWidth()/2*-1,zIndex:l.zIndex+3}),a.height()+80>=e(window).height()&&("absolute"!=a.css("position")||r)){var t=e(document).scrollTop()+40;a.css({position:"absolute",top:t+"px",marginTop:0}),r&&o.removeExpression("top")}else if(a.height()+80<e(window).height())if(r)if(o.position="absolute",l.centered)o.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"'),o.marginTop=0;else{var n=l.modalCSS&&l.modalCSS.top?parseInt(l.modalCSS.top):0;o.setExpression("top","((blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+n+') + "px"')}else l.centered?a.css({position:"fixed",top:"50%",marginTop:a.outerHeight()/2*-1}):a.css({position:"fixed"}).css(l.modalCSS)}var l=e.extend({},e.fn.lightbox_me.defaults,o),c=e(),a=e(this),d=e('<iframe id="foo" style="z-index: '+(l.zIndex+1)+';border: none; margin: 0; padding: 0; position: absolute; width: 100%; height: 100%; top: 0; left: 0; filter: mask();"/>'),r=e.browser.msie&&e.browser.version<7;if(l.showOverlay){var p=e(".js_lb_overlay:visible");p.length>0?c=e('<div class="lb_overlay_clear js_lb_overlay"/>'):(e("."+l.classPrefix+"_overlay.js_lb_overlay").remove(),c=e('<div class="'+l.classPrefix+'_overlay js_lb_overlay"/>'))}if(r){var h=/^https/i.test(window.location.href||"")?"javascript:false":"about:blank";d.attr("src",h),e("body").append(d)}e("body").append(a.hide()).append(c),l.showOverlay&&(i(),c.css({position:"absolute",width:"100%",top:0,left:0,right:0,bottom:0,zIndex:l.zIndex+2,display:"none"}),c.hasClass("lb_overlay_clear")||c.css(l.overlayCSS)),l.showOverlay?c.fadeIn(l.overlaySpeed,function(){s(),a[l.appearEffect](l.lightboxSpeed,function(){i(),s(),l.onLoad()})}):(s(),a[l.appearEffect](l.lightboxSpeed,function(){l.onLoad()})),l.parentLightbox&&l.parentLightbox.fadeOut(200),e(window).resize(i).resize(s).scroll(s),e(window).bind("keyup.lightbox_me",n),l.closeClick&&c.click(function(e){t(),e.preventDefault}),a.delegate(l.closeSelector,"click",function(e){t(),e.preventDefault()}),a.bind("close",t),a.bind("reposition",s)})},e.fn.lightbox_me.defaults={appearEffect:"fadeIn",appearEase:"",overlaySpeed:250,lightboxSpeed:300,closeSelector:".close",closeClick:!0,closeEsc:!0,destroyOnClose:!1,showOverlay:!0,parentLightbox:!1,onLoad:function(){},onClose:function(){},classPrefix:"lb",zIndex:999,centered:!1,modalCSS:{top:"40px"},overlayCSS:{background:"black",opacity:.3}}}(jQuery);